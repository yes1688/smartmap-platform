# Frontend Build Container - 只構建前端，不運行
# 用於生產環境，將構建好的 dist/ 複製到 volume

FROM node:18-alpine AS builder

WORKDIR /app

# 複製 package 文件
COPY package*.json ./

# 安裝依賴
RUN npm ci

# 複製源代碼
COPY . .

# 構建應用
RUN npm run build

# 使用輕量級映像來持有構建結果
FROM alpine:latest

WORKDIR /dist

# 從 builder 階段複製構建產物
COPY --from=builder /app/dist /dist

# 這個容器的唯一目的是持有 /dist 目錄
# 它會立即退出，但 volume 會保留檔案
CMD ["echo", "Frontend build completed. Files are in /dist"]
